description: 'Testing verbs for arpnd: show summarize unique'
tests:
- command: arpnd show --format=json
  data-directory: tests/data/nxos/parquet-out/
  marks: arpnd show nxos
  output: '[{"namespace": "nxos", "hostname": "server101", "ipAddress": "10.255.2.1",
    "oif": "eth0", "macaddr": "52:54:00:9b:7d:db", "state": "reachable", "remote":
    false, "timestamp": 1619275256310}, {"namespace": "nxos", "hostname": "server101",
    "ipAddress": "172.16.1.254", "oif": "bond0", "macaddr": "00:00:00:11:12:10", "state":
    "reachable", "remote": false, "timestamp": 1619275256310}, {"namespace": "nxos",
    "hostname": "server102", "ipAddress": "172.16.3.202", "oif": "bond0", "macaddr":
    "0a:b5:b6:22:53:72", "state": "reachable", "remote": false, "timestamp": 1619275256394},
    {"namespace": "nxos", "hostname": "server102", "ipAddress": "172.16.3.254", "oif":
    "bond0", "macaddr": "00:00:00:11:12:10", "state": "reachable", "remote": false,
    "timestamp": 1619275256394}, {"namespace": "nxos", "hostname": "server102", "ipAddress":
    "10.255.2.1", "oif": "eth0", "macaddr": "52:54:00:9b:7d:db", "state": "reachable",
    "remote": false, "timestamp": 1619275256394}, {"namespace": "nxos", "hostname":
    "server301", "ipAddress": "172.16.2.254", "oif": "bond0", "macaddr": "00:00:00:11:12:10",
    "state": "reachable", "remote": false, "timestamp": 1619275256403}, {"namespace":
    "nxos", "hostname": "server301", "ipAddress": "10.255.2.1", "oif": "eth0", "macaddr":
    "52:54:00:9b:7d:db", "state": "reachable", "remote": false, "timestamp": 1619275256403},
    {"namespace": "nxos", "hostname": "server302", "ipAddress": "172.16.3.102", "oif":
    "bond0", "macaddr": "da:bf:63:c6:2f:0a", "state": "reachable", "remote": false,
    "timestamp": 1619275256425}, {"namespace": "nxos", "hostname": "server302", "ipAddress":
    "10.255.2.1", "oif": "eth0", "macaddr": "52:54:00:9b:7d:db", "state": "reachable",
    "remote": false, "timestamp": 1619275256425}, {"namespace": "nxos", "hostname":
    "server302", "ipAddress": "172.16.3.254", "oif": "bond0", "macaddr": "00:00:00:11:12:10",
    "state": "reachable", "remote": false, "timestamp": 1619275256425}, {"namespace":
    "nxos", "hostname": "firewall01", "ipAddress": "169.254.253.5", "oif": "eth2.3",
    "macaddr": "44:01:03:02:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275256617}, {"namespace": "nxos", "hostname": "firewall01", "ipAddress": "169.254.253.9",
    "oif": "eth2.4", "macaddr": "44:01:03:02:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275256617}, {"namespace": "nxos", "hostname": "firewall01",
    "ipAddress": "169.254.254.1", "oif": "eth1.2", "macaddr": "44:01:03:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275256617}, {"namespace":
    "nxos", "hostname": "firewall01", "ipAddress": "169.254.253.1", "oif": "eth2.2",
    "macaddr": "44:01:03:02:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275256617}, {"namespace": "nxos", "hostname": "firewall01", "ipAddress": "10.255.2.1",
    "oif": "eth0", "macaddr": "52:54:00:9b:7d:db", "state": "reachable", "remote":
    false, "timestamp": 1619275256617}, {"namespace": "nxos", "hostname": "firewall01",
    "ipAddress": "fe80::5054:ff:fe6e:32d5", "oif": "eth0", "macaddr": "52:54:00:6e:32:d5",
    "state": "reachable", "remote": false, "timestamp": 1619275256617}, {"namespace":
    "nxos", "hostname": "firewall01", "ipAddress": "169.254.254.5", "oif": "eth1.3",
    "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275256617}, {"namespace": "nxos", "hostname": "firewall01", "ipAddress": "169.254.254.9",
    "oif": "eth1.4", "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275256617}, {"namespace": "nxos", "hostname": "dcedge01",
    "ipAddress": "10.255.2.1", "oif": "em0.0", "macaddr": "52:54:00:9b:7d:db", "state":
    "reachable", "remote": false, "timestamp": 1619275261428}, {"namespace": "nxos",
    "hostname": "dcedge01", "ipAddress": "169.254.127.3", "oif": "xe-0/0/1.0", "macaddr":
    "44:01:03:02:1b:08", "state": "reachable", "remote": false, "timestamp": 1619275261428},
    {"namespace": "nxos", "hostname": "dcedge01", "ipAddress": "169.254.127.1", "oif":
    "xe-0/0/0.0", "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275261428}, {"namespace": "nxos", "hostname": "dcedge01",
    "ipAddress": "169.254.0.1", "oif": "em1.0", "macaddr": "52:54:00:7d:05:4f", "state":
    "reachable", "remote": false, "timestamp": 1619275261428}, {"namespace": "nxos",
    "hostname": "spine02", "ipAddress": "10.0.0.11", "oif": "Ethernet1/1", "macaddr":
    "44:01:02:01:1b:08", "state": "reachable", "remote": false, "timestamp": 1619275262853},
    {"namespace": "nxos", "hostname": "spine02", "ipAddress": "10.0.0.12", "oif":
    "Ethernet1/2", "macaddr": "44:01:02:02:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275262853}, {"namespace": "nxos", "hostname": "spine02",
    "ipAddress": "10.0.0.13", "oif": "Ethernet1/3", "macaddr": "44:01:02:03:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275262853}, {"namespace":
    "nxos", "hostname": "spine02", "ipAddress": "10.0.0.14", "oif": "Ethernet1/4",
    "macaddr": "44:01:02:04:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275262853}, {"namespace": "nxos", "hostname": "spine02", "ipAddress": "10.255.2.1",
    "oif": "mgmt0", "macaddr": "52:54:00:9b:7d:db", "state": "reachable", "remote":
    false, "timestamp": 1619275262853}, {"namespace": "nxos", "hostname": "spine02",
    "ipAddress": "10.0.0.31", "oif": "Ethernet1/5", "macaddr": "44:01:03:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275262853}, {"namespace":
    "nxos", "hostname": "spine02", "ipAddress": "10.0.0.32", "oif": "Ethernet1/6",
    "macaddr": "44:01:03:02:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275262853}, {"namespace": "nxos", "hostname": "leaf03", "ipAddress": "172.16.2.201",
    "oif": "Vlan20", "macaddr": "06:a8:f1:19:b8:b3", "state": "reachable", "remote":
    false, "timestamp": 1619275263495}, {"namespace": "nxos", "hostname": "leaf03",
    "ipAddress": "172.16.3.202", "oif": "Vlan30", "macaddr": "0a:b5:b6:22:53:72",
    "state": "reachable", "remote": false, "timestamp": 1619275263495}, {"namespace":
    "nxos", "hostname": "leaf03", "ipAddress": "10.0.0.22", "oif": "Ethernet1/2",
    "macaddr": "44:01:01:02:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275263495}, {"namespace": "nxos", "hostname": "leaf03", "ipAddress": "10.0.0.21",
    "oif": "Ethernet1/1", "macaddr": "44:01:01:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275263495}, {"namespace": "nxos", "hostname": "leaf03",
    "ipAddress": "10.255.2.191", "oif": "mgmt0", "macaddr": "44:38:39:01:02:04", "state":
    "reachable", "remote": false, "timestamp": 1619275263495}, {"namespace": "nxos",
    "hostname": "leaf03", "ipAddress": "10.255.2.1", "oif": "mgmt0", "macaddr": "52:54:00:9b:7d:db",
    "state": "reachable", "remote": false, "timestamp": 1619275263495}, {"namespace":
    "nxos", "hostname": "spine01", "ipAddress": "10.0.0.11", "oif": "Ethernet1/1",
    "macaddr": "44:01:02:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275263663}, {"namespace": "nxos", "hostname": "spine01", "ipAddress": "10.0.0.13",
    "oif": "Ethernet1/3", "macaddr": "44:01:02:03:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275263663}, {"namespace": "nxos", "hostname": "spine01",
    "ipAddress": "10.0.0.14", "oif": "Ethernet1/4", "macaddr": "44:01:02:04:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275263663}, {"namespace":
    "nxos", "hostname": "spine01", "ipAddress": "10.0.0.32", "oif": "Ethernet1/6",
    "macaddr": "44:01:03:02:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275263663}, {"namespace": "nxos", "hostname": "spine01", "ipAddress": "10.255.2.1",
    "oif": "mgmt0", "macaddr": "52:54:00:9b:7d:db", "state": "reachable", "remote":
    false, "timestamp": 1619275263663}, {"namespace": "nxos", "hostname": "spine01",
    "ipAddress": "10.0.0.31", "oif": "Ethernet1/5", "macaddr": "44:01:03:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275263663}, {"namespace":
    "nxos", "hostname": "spine01", "ipAddress": "10.0.0.12", "oif": "Ethernet1/2",
    "macaddr": "44:01:02:02:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275263663}, {"namespace": "nxos", "hostname": "exit02", "ipAddress": "10.255.2.1",
    "oif": "mgmt0", "macaddr": "52:54:00:9b:7d:db", "state": "reachable", "remote":
    false, "timestamp": 1619275264340}, {"namespace": "nxos", "hostname": "exit02",
    "ipAddress": "10.0.0.21", "oif": "Ethernet1/1", "macaddr": "44:01:01:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275264340}, {"namespace":
    "nxos", "hostname": "exit02", "ipAddress": "169.254.253.6", "oif": "Ethernet1/3.3",
    "macaddr": "52:54:00:86:df:51", "state": "reachable", "remote": false, "timestamp":
    1619275264340}, {"namespace": "nxos", "hostname": "exit02", "ipAddress": "169.254.253.2",
    "oif": "Ethernet1/3.2", "macaddr": "52:54:00:86:df:51", "state": "reachable",
    "remote": false, "timestamp": 1619275264340}, {"namespace": "nxos", "hostname":
    "exit02", "ipAddress": "169.254.253.10", "oif": "Ethernet1/3.4", "macaddr": "52:54:00:86:df:51",
    "state": "reachable", "remote": false, "timestamp": 1619275264340}, {"namespace":
    "nxos", "hostname": "exit02", "ipAddress": "169.254.127.2", "oif": "Ethernet1/4",
    "macaddr": "02:05:86:71:3c:07", "state": "reachable", "remote": false, "timestamp":
    1619275264340}, {"namespace": "nxos", "hostname": "exit02", "ipAddress": "10.0.0.22",
    "oif": "Ethernet1/2", "macaddr": "44:01:01:02:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275264340}, {"namespace": "nxos", "hostname": "exit01",
    "ipAddress": "169.254.254.2", "oif": "Ethernet1/3.2", "macaddr": "52:54:00:c9:b8:2d",
    "state": "reachable", "remote": false, "timestamp": 1619275264358}, {"namespace":
    "nxos", "hostname": "exit01", "ipAddress": "169.254.254.6", "oif": "Ethernet1/3.3",
    "macaddr": "52:54:00:c9:b8:2d", "state": "reachable", "remote": false, "timestamp":
    1619275264358}, {"namespace": "nxos", "hostname": "exit01", "ipAddress": "169.254.254.10",
    "oif": "Ethernet1/3.4", "macaddr": "52:54:00:c9:b8:2d", "state": "reachable",
    "remote": false, "timestamp": 1619275264358}, {"namespace": "nxos", "hostname":
    "exit01", "ipAddress": "169.254.127.0", "oif": "Ethernet1/4", "macaddr": "02:05:86:71:3c:03",
    "state": "reachable", "remote": false, "timestamp": 1619275264358}, {"namespace":
    "nxos", "hostname": "exit01", "ipAddress": "10.0.0.22", "oif": "Ethernet1/2",
    "macaddr": "44:01:01:02:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275264358}, {"namespace": "nxos", "hostname": "exit01", "ipAddress": "10.0.0.21",
    "oif": "Ethernet1/1", "macaddr": "44:01:01:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275264358}, {"namespace": "nxos", "hostname": "exit01",
    "ipAddress": "10.255.2.1", "oif": "mgmt0", "macaddr": "52:54:00:9b:7d:db", "state":
    "reachable", "remote": false, "timestamp": 1619275264358}, {"namespace": "nxos",
    "hostname": "leaf02", "ipAddress": "172.16.1.101", "oif": "Vlan10", "macaddr":
    "32:bb:c5:b5:3a:20", "state": "reachable", "remote": false, "timestamp": 1619275264428},
    {"namespace": "nxos", "hostname": "leaf02", "ipAddress": "10.255.2.1", "oif":
    "mgmt0", "macaddr": "52:54:00:9b:7d:db", "state": "reachable", "remote": false,
    "timestamp": 1619275264428}, {"namespace": "nxos", "hostname": "leaf02", "ipAddress":
    "10.255.2.189", "oif": "mgmt0", "macaddr": "44:38:39:01:02:01", "state": "reachable",
    "remote": false, "timestamp": 1619275264428}, {"namespace": "nxos", "hostname":
    "leaf02", "ipAddress": "10.0.0.21", "oif": "Ethernet1/1", "macaddr": "44:01:01:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275264428}, {"namespace":
    "nxos", "hostname": "leaf02", "ipAddress": "10.0.0.22", "oif": "Ethernet1/2",
    "macaddr": "44:01:01:02:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275264428}, {"namespace": "nxos", "hostname": "leaf02", "ipAddress": "172.16.3.102",
    "oif": "Vlan30", "macaddr": "da:bf:63:c6:2f:0a", "state": "reachable", "remote":
    false, "timestamp": 1619275264428}, {"namespace": "nxos", "hostname": "leaf01",
    "ipAddress": "10.255.2.1", "oif": "mgmt0", "macaddr": "52:54:00:9b:7d:db", "state":
    "reachable", "remote": false, "timestamp": 1619275264429}, {"namespace": "nxos",
    "hostname": "leaf01", "ipAddress": "172.16.1.101", "oif": "Vlan10", "macaddr":
    "32:bb:c5:b5:3a:20", "state": "reachable", "remote": false, "timestamp": 1619275264429},
    {"namespace": "nxos", "hostname": "leaf01", "ipAddress": "172.16.3.102", "oif":
    "Vlan30", "macaddr": "da:bf:63:c6:2f:0a", "state": "reachable", "remote": false,
    "timestamp": 1619275264429}, {"namespace": "nxos", "hostname": "leaf01", "ipAddress":
    "10.255.2.188", "oif": "mgmt0", "macaddr": "44:38:39:01:02:02", "state": "reachable",
    "remote": false, "timestamp": 1619275264429}, {"namespace": "nxos", "hostname":
    "leaf01", "ipAddress": "10.0.0.21", "oif": "Ethernet1/1", "macaddr": "44:01:01:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275264429}, {"namespace":
    "nxos", "hostname": "leaf01", "ipAddress": "10.0.0.22", "oif": "Ethernet1/2",
    "macaddr": "44:01:01:02:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275264429}, {"namespace": "nxos", "hostname": "leaf04", "ipAddress": "10.255.2.1",
    "oif": "mgmt0", "macaddr": "52:54:00:9b:7d:db", "state": "reachable", "remote":
    false, "timestamp": 1619275264853}, {"namespace": "nxos", "hostname": "leaf04",
    "ipAddress": "10.255.2.190", "oif": "mgmt0", "macaddr": "44:38:39:01:02:03", "state":
    "reachable", "remote": false, "timestamp": 1619275264853}, {"namespace": "nxos",
    "hostname": "leaf04", "ipAddress": "10.0.0.21", "oif": "Ethernet1/1", "macaddr":
    "44:01:01:01:1b:08", "state": "reachable", "remote": false, "timestamp": 1619275264853},
    {"namespace": "nxos", "hostname": "leaf04", "ipAddress": "10.0.0.22", "oif": "Ethernet1/2",
    "macaddr": "44:01:01:02:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275264853}, {"namespace": "nxos", "hostname": "leaf04", "ipAddress": "172.16.2.201",
    "oif": "Vlan20", "macaddr": "06:a8:f1:19:b8:b3", "state": "reachable", "remote":
    false, "timestamp": 1619275264853}, {"namespace": "nxos", "hostname": "leaf04",
    "ipAddress": "172.16.3.202", "oif": "Vlan30", "macaddr": "0a:b5:b6:22:53:72",
    "state": "reachable", "remote": false, "timestamp": 1619275264853}]'
- command: arpnd show --columns=hostname --format=json
  data-directory: tests/data/nxos/parquet-out/
  marks: arpnd show nxos
  output: '[{"hostname": "server101"}, {"hostname": "server101"}, {"hostname": "server102"},
    {"hostname": "server102"}, {"hostname": "server102"}, {"hostname": "server301"},
    {"hostname": "server301"}, {"hostname": "server302"}, {"hostname": "server302"},
    {"hostname": "server302"}, {"hostname": "firewall01"}, {"hostname": "firewall01"},
    {"hostname": "firewall01"}, {"hostname": "firewall01"}, {"hostname": "firewall01"},
    {"hostname": "firewall01"}, {"hostname": "firewall01"}, {"hostname": "firewall01"},
    {"hostname": "dcedge01"}, {"hostname": "dcedge01"}, {"hostname": "dcedge01"},
    {"hostname": "dcedge01"}, {"hostname": "spine02"}, {"hostname": "spine02"}, {"hostname":
    "spine02"}, {"hostname": "spine02"}, {"hostname": "spine02"}, {"hostname": "spine02"},
    {"hostname": "spine02"}, {"hostname": "leaf03"}, {"hostname": "leaf03"}, {"hostname":
    "leaf03"}, {"hostname": "leaf03"}, {"hostname": "leaf03"}, {"hostname": "leaf03"},
    {"hostname": "spine01"}, {"hostname": "spine01"}, {"hostname": "spine01"}, {"hostname":
    "spine01"}, {"hostname": "spine01"}, {"hostname": "spine01"}, {"hostname": "spine01"},
    {"hostname": "exit02"}, {"hostname": "exit02"}, {"hostname": "exit02"}, {"hostname":
    "exit02"}, {"hostname": "exit02"}, {"hostname": "exit02"}, {"hostname": "exit02"},
    {"hostname": "exit01"}, {"hostname": "exit01"}, {"hostname": "exit01"}, {"hostname":
    "exit01"}, {"hostname": "exit01"}, {"hostname": "exit01"}, {"hostname": "exit01"},
    {"hostname": "leaf02"}, {"hostname": "leaf02"}, {"hostname": "leaf02"}, {"hostname":
    "leaf02"}, {"hostname": "leaf02"}, {"hostname": "leaf02"}, {"hostname": "leaf01"},
    {"hostname": "leaf01"}, {"hostname": "leaf01"}, {"hostname": "leaf01"}, {"hostname":
    "leaf01"}, {"hostname": "leaf01"}, {"hostname": "leaf04"}, {"hostname": "leaf04"},
    {"hostname": "leaf04"}, {"hostname": "leaf04"}, {"hostname": "leaf04"}, {"hostname":
    "leaf04"}]'
- command: arpnd summarize --format=json
  data-directory: tests/data/nxos/parquet-out/
  marks: arpnd summarize nxos
  output: '{"nxos": {"deviceCnt": 14, "macaddrCnt": 74, "oifCnt": 74, "uniqueOifCnt":
    25, "arpNdEntriesCnt": 74, "arpNdV4EntriesCnt": 73, "arpNdV6EntriesCnt": 1, "arpNdV6GlobalEntriesCnt":
    1, "arpNdV6LLAEntriesCnt": 0, "remoteV4EntriesCnt": 0, "staticV4EntriesCnt": 0,
    "failedV4EntryCnt": 0, "remoteV6EntriesCnt": 0, "staticV6EntriesCnt": 0, "failedV6EntryCnt":
    0}}'
- command: arpnd unique --format=json
  data-directory: tests/data/nxos/parquet-out/
  marks: arpnd unique nxos
  output: '[{"hostname": "dcedge01"}, {"hostname": "exit01"}, {"hostname": "exit02"},
    {"hostname": "firewall01"}, {"hostname": "leaf01"}, {"hostname": "leaf02"}, {"hostname":
    "leaf03"}, {"hostname": "leaf04"}, {"hostname": "server101"}, {"hostname": "server102"},
    {"hostname": "server301"}, {"hostname": "server302"}, {"hostname": "spine01"},
    {"hostname": "spine02"}]'
- command: arpnd unique --count=True --format=json
  data-directory: tests/data/nxos/parquet-out/
  marks: arpnd unique nxos
  output: '[{"hostname": "server101", "numRows": 2}, {"hostname": "server301", "numRows":
    2}, {"hostname": "server102", "numRows": 3}, {"hostname": "server302", "numRows":
    3}, {"hostname": "dcedge01", "numRows": 4}, {"hostname": "leaf01", "numRows":
    6}, {"hostname": "leaf02", "numRows": 6}, {"hostname": "leaf03", "numRows": 6},
    {"hostname": "leaf04", "numRows": 6}, {"hostname": "exit01", "numRows": 7}, {"hostname":
    "exit02", "numRows": 7}, {"hostname": "spine01", "numRows": 7}, {"hostname": "spine02",
    "numRows": 7}, {"hostname": "firewall01", "numRows": 8}]'
- command: arpnd unique --columns=hostname --format=json
  data-directory: tests/data/nxos/parquet-out/
  marks: arpnd unique nxos
  output: '[{"hostname": "dcedge01"}, {"hostname": "exit01"}, {"hostname": "exit02"},
    {"hostname": "firewall01"}, {"hostname": "leaf01"}, {"hostname": "leaf02"}, {"hostname":
    "leaf03"}, {"hostname": "leaf04"}, {"hostname": "server101"}, {"hostname": "server102"},
    {"hostname": "server301"}, {"hostname": "server302"}, {"hostname": "spine01"},
    {"hostname": "spine02"}]'
- command: arpnd show --oif="Ethernet1/1" --format=json
  data-directory: tests/data/nxos/parquet-out/
  marks: arpnd show nxos
  output: '[{"namespace": "nxos", "hostname": "spine02", "ipAddress": "10.0.0.11",
    "oif": "Ethernet1/1", "macaddr": "44:01:02:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275262853}, {"namespace": "nxos", "hostname": "leaf03",
    "ipAddress": "10.0.0.21", "oif": "Ethernet1/1", "macaddr": "44:01:01:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275263495}, {"namespace":
    "nxos", "hostname": "spine01", "ipAddress": "10.0.0.11", "oif": "Ethernet1/1",
    "macaddr": "44:01:02:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275263663}, {"namespace": "nxos", "hostname": "exit02", "ipAddress": "10.0.0.21",
    "oif": "Ethernet1/1", "macaddr": "44:01:01:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275264340}, {"namespace": "nxos", "hostname": "exit01",
    "ipAddress": "10.0.0.21", "oif": "Ethernet1/1", "macaddr": "44:01:01:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275264358}, {"namespace":
    "nxos", "hostname": "leaf02", "ipAddress": "10.0.0.21", "oif": "Ethernet1/1",
    "macaddr": "44:01:01:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275264428}, {"namespace": "nxos", "hostname": "leaf01", "ipAddress": "10.0.0.21",
    "oif": "Ethernet1/1", "macaddr": "44:01:01:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275264429}, {"namespace": "nxos", "hostname": "leaf04",
    "ipAddress": "10.0.0.21", "oif": "Ethernet1/1", "macaddr": "44:01:01:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275264853}]'
- command: arpnd show --address=10.0.0.21 --format=json
  data-directory: tests/data/nxos/parquet-out/
  marks: arpnd show nxos
  output: '[{"namespace": "nxos", "hostname": "leaf03", "ipAddress": "10.0.0.21",
    "oif": "Ethernet1/1", "macaddr": "44:01:01:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275263495}, {"namespace": "nxos", "hostname": "exit02",
    "ipAddress": "10.0.0.21", "oif": "Ethernet1/1", "macaddr": "44:01:01:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275264340}, {"namespace":
    "nxos", "hostname": "exit01", "ipAddress": "10.0.0.21", "oif": "Ethernet1/1",
    "macaddr": "44:01:01:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275264358}, {"namespace": "nxos", "hostname": "leaf02", "ipAddress": "10.0.0.21",
    "oif": "Ethernet1/1", "macaddr": "44:01:01:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275264428}, {"namespace": "nxos", "hostname": "leaf01",
    "ipAddress": "10.0.0.21", "oif": "Ethernet1/1", "macaddr": "44:01:01:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275264429}, {"namespace":
    "nxos", "hostname": "leaf04", "ipAddress": "10.0.0.21", "oif": "Ethernet1/1",
    "macaddr": "44:01:01:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275264853}]'
- command: arpnd show --format=json --columns='*'
  data-directory: tests/data/nxos/parquet-out/
  marks: arpnd show nxos
  output: '[{"namespace": "nxos", "hostname": "server101", "ipAddress": "10.255.2.1",
    "oif": "eth0", "macaddr": "52:54:00:9b:7d:db", "state": "reachable", "remote":
    false, "timestamp": 1619275256310, "active": true}, {"namespace": "nxos", "hostname":
    "server101", "ipAddress": "172.16.1.254", "oif": "bond0", "macaddr": "00:00:00:11:12:10",
    "state": "reachable", "remote": false, "timestamp": 1619275256310, "active": true},
    {"namespace": "nxos", "hostname": "server102", "ipAddress": "172.16.3.202", "oif":
    "bond0", "macaddr": "0a:b5:b6:22:53:72", "state": "reachable", "remote": false,
    "timestamp": 1619275256394, "active": true}, {"namespace": "nxos", "hostname":
    "server102", "ipAddress": "172.16.3.254", "oif": "bond0", "macaddr": "00:00:00:11:12:10",
    "state": "reachable", "remote": false, "timestamp": 1619275256394, "active": true},
    {"namespace": "nxos", "hostname": "server102", "ipAddress": "10.255.2.1", "oif":
    "eth0", "macaddr": "52:54:00:9b:7d:db", "state": "reachable", "remote": false,
    "timestamp": 1619275256394, "active": true}, {"namespace": "nxos", "hostname":
    "server301", "ipAddress": "172.16.2.254", "oif": "bond0", "macaddr": "00:00:00:11:12:10",
    "state": "reachable", "remote": false, "timestamp": 1619275256403, "active": true},
    {"namespace": "nxos", "hostname": "server301", "ipAddress": "10.255.2.1", "oif":
    "eth0", "macaddr": "52:54:00:9b:7d:db", "state": "reachable", "remote": false,
    "timestamp": 1619275256403, "active": true}, {"namespace": "nxos", "hostname":
    "server302", "ipAddress": "172.16.3.102", "oif": "bond0", "macaddr": "da:bf:63:c6:2f:0a",
    "state": "reachable", "remote": false, "timestamp": 1619275256425, "active": true},
    {"namespace": "nxos", "hostname": "server302", "ipAddress": "10.255.2.1", "oif":
    "eth0", "macaddr": "52:54:00:9b:7d:db", "state": "reachable", "remote": false,
    "timestamp": 1619275256425, "active": true}, {"namespace": "nxos", "hostname":
    "server302", "ipAddress": "172.16.3.254", "oif": "bond0", "macaddr": "00:00:00:11:12:10",
    "state": "reachable", "remote": false, "timestamp": 1619275256425, "active": true},
    {"namespace": "nxos", "hostname": "firewall01", "ipAddress": "169.254.253.5",
    "oif": "eth2.3", "macaddr": "44:01:03:02:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275256617, "active": true}, {"namespace": "nxos", "hostname":
    "firewall01", "ipAddress": "169.254.253.9", "oif": "eth2.4", "macaddr": "44:01:03:02:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275256617, "active": true},
    {"namespace": "nxos", "hostname": "firewall01", "ipAddress": "169.254.254.1",
    "oif": "eth1.2", "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275256617, "active": true}, {"namespace": "nxos", "hostname":
    "firewall01", "ipAddress": "169.254.253.1", "oif": "eth2.2", "macaddr": "44:01:03:02:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275256617, "active": true},
    {"namespace": "nxos", "hostname": "firewall01", "ipAddress": "10.255.2.1", "oif":
    "eth0", "macaddr": "52:54:00:9b:7d:db", "state": "reachable", "remote": false,
    "timestamp": 1619275256617, "active": true}, {"namespace": "nxos", "hostname":
    "firewall01", "ipAddress": "fe80::5054:ff:fe6e:32d5", "oif": "eth0", "macaddr":
    "52:54:00:6e:32:d5", "state": "reachable", "remote": false, "timestamp": 1619275256617,
    "active": true}, {"namespace": "nxos", "hostname": "firewall01", "ipAddress":
    "169.254.254.5", "oif": "eth1.3", "macaddr": "44:01:03:01:1b:08", "state": "reachable",
    "remote": false, "timestamp": 1619275256617, "active": true}, {"namespace": "nxos",
    "hostname": "firewall01", "ipAddress": "169.254.254.9", "oif": "eth1.4", "macaddr":
    "44:01:03:01:1b:08", "state": "reachable", "remote": false, "timestamp": 1619275256617,
    "active": true}, {"namespace": "nxos", "hostname": "dcedge01", "ipAddress": "10.255.2.1",
    "oif": "em0.0", "macaddr": "52:54:00:9b:7d:db", "state": "reachable", "remote":
    false, "timestamp": 1619275261428, "active": true}, {"namespace": "nxos", "hostname":
    "dcedge01", "ipAddress": "169.254.127.3", "oif": "xe-0/0/1.0", "macaddr": "44:01:03:02:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275261428, "active": true},
    {"namespace": "nxos", "hostname": "dcedge01", "ipAddress": "169.254.127.1", "oif":
    "xe-0/0/0.0", "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275261428, "active": true}, {"namespace": "nxos", "hostname":
    "dcedge01", "ipAddress": "169.254.0.1", "oif": "em1.0", "macaddr": "52:54:00:7d:05:4f",
    "state": "reachable", "remote": false, "timestamp": 1619275261428, "active": true},
    {"namespace": "nxos", "hostname": "spine02", "ipAddress": "10.0.0.11", "oif":
    "Ethernet1/1", "macaddr": "44:01:02:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275262853, "active": true}, {"namespace": "nxos", "hostname":
    "spine02", "ipAddress": "10.0.0.12", "oif": "Ethernet1/2", "macaddr": "44:01:02:02:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275262853, "active": true},
    {"namespace": "nxos", "hostname": "spine02", "ipAddress": "10.0.0.13", "oif":
    "Ethernet1/3", "macaddr": "44:01:02:03:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275262853, "active": true}, {"namespace": "nxos", "hostname":
    "spine02", "ipAddress": "10.0.0.14", "oif": "Ethernet1/4", "macaddr": "44:01:02:04:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275262853, "active": true},
    {"namespace": "nxos", "hostname": "spine02", "ipAddress": "10.255.2.1", "oif":
    "mgmt0", "macaddr": "52:54:00:9b:7d:db", "state": "reachable", "remote": false,
    "timestamp": 1619275262853, "active": true}, {"namespace": "nxos", "hostname":
    "spine02", "ipAddress": "10.0.0.31", "oif": "Ethernet1/5", "macaddr": "44:01:03:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275262853, "active": true},
    {"namespace": "nxos", "hostname": "spine02", "ipAddress": "10.0.0.32", "oif":
    "Ethernet1/6", "macaddr": "44:01:03:02:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275262853, "active": true}, {"namespace": "nxos", "hostname":
    "leaf03", "ipAddress": "172.16.2.201", "oif": "Vlan20", "macaddr": "06:a8:f1:19:b8:b3",
    "state": "reachable", "remote": false, "timestamp": 1619275263495, "active": true},
    {"namespace": "nxos", "hostname": "leaf03", "ipAddress": "172.16.3.202", "oif":
    "Vlan30", "macaddr": "0a:b5:b6:22:53:72", "state": "reachable", "remote": false,
    "timestamp": 1619275263495, "active": true}, {"namespace": "nxos", "hostname":
    "leaf03", "ipAddress": "10.0.0.22", "oif": "Ethernet1/2", "macaddr": "44:01:01:02:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275263495, "active": true},
    {"namespace": "nxos", "hostname": "leaf03", "ipAddress": "10.0.0.21", "oif": "Ethernet1/1",
    "macaddr": "44:01:01:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275263495, "active": true}, {"namespace": "nxos", "hostname": "leaf03", "ipAddress":
    "10.255.2.191", "oif": "mgmt0", "macaddr": "44:38:39:01:02:04", "state": "reachable",
    "remote": false, "timestamp": 1619275263495, "active": true}, {"namespace": "nxos",
    "hostname": "leaf03", "ipAddress": "10.255.2.1", "oif": "mgmt0", "macaddr": "52:54:00:9b:7d:db",
    "state": "reachable", "remote": false, "timestamp": 1619275263495, "active": true},
    {"namespace": "nxos", "hostname": "spine01", "ipAddress": "10.0.0.11", "oif":
    "Ethernet1/1", "macaddr": "44:01:02:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275263663, "active": true}, {"namespace": "nxos", "hostname":
    "spine01", "ipAddress": "10.0.0.13", "oif": "Ethernet1/3", "macaddr": "44:01:02:03:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275263663, "active": true},
    {"namespace": "nxos", "hostname": "spine01", "ipAddress": "10.0.0.14", "oif":
    "Ethernet1/4", "macaddr": "44:01:02:04:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275263663, "active": true}, {"namespace": "nxos", "hostname":
    "spine01", "ipAddress": "10.0.0.32", "oif": "Ethernet1/6", "macaddr": "44:01:03:02:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275263663, "active": true},
    {"namespace": "nxos", "hostname": "spine01", "ipAddress": "10.255.2.1", "oif":
    "mgmt0", "macaddr": "52:54:00:9b:7d:db", "state": "reachable", "remote": false,
    "timestamp": 1619275263663, "active": true}, {"namespace": "nxos", "hostname":
    "spine01", "ipAddress": "10.0.0.31", "oif": "Ethernet1/5", "macaddr": "44:01:03:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275263663, "active": true},
    {"namespace": "nxos", "hostname": "spine01", "ipAddress": "10.0.0.12", "oif":
    "Ethernet1/2", "macaddr": "44:01:02:02:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275263663, "active": true}, {"namespace": "nxos", "hostname":
    "exit02", "ipAddress": "10.255.2.1", "oif": "mgmt0", "macaddr": "52:54:00:9b:7d:db",
    "state": "reachable", "remote": false, "timestamp": 1619275264340, "active": true},
    {"namespace": "nxos", "hostname": "exit02", "ipAddress": "10.0.0.21", "oif": "Ethernet1/1",
    "macaddr": "44:01:01:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275264340, "active": true}, {"namespace": "nxos", "hostname": "exit02", "ipAddress":
    "169.254.253.6", "oif": "Ethernet1/3.3", "macaddr": "52:54:00:86:df:51", "state":
    "reachable", "remote": false, "timestamp": 1619275264340, "active": true}, {"namespace":
    "nxos", "hostname": "exit02", "ipAddress": "169.254.253.2", "oif": "Ethernet1/3.2",
    "macaddr": "52:54:00:86:df:51", "state": "reachable", "remote": false, "timestamp":
    1619275264340, "active": true}, {"namespace": "nxos", "hostname": "exit02", "ipAddress":
    "169.254.253.10", "oif": "Ethernet1/3.4", "macaddr": "52:54:00:86:df:51", "state":
    "reachable", "remote": false, "timestamp": 1619275264340, "active": true}, {"namespace":
    "nxos", "hostname": "exit02", "ipAddress": "169.254.127.2", "oif": "Ethernet1/4",
    "macaddr": "02:05:86:71:3c:07", "state": "reachable", "remote": false, "timestamp":
    1619275264340, "active": true}, {"namespace": "nxos", "hostname": "exit02", "ipAddress":
    "10.0.0.22", "oif": "Ethernet1/2", "macaddr": "44:01:01:02:1b:08", "state": "reachable",
    "remote": false, "timestamp": 1619275264340, "active": true}, {"namespace": "nxos",
    "hostname": "exit01", "ipAddress": "169.254.254.2", "oif": "Ethernet1/3.2", "macaddr":
    "52:54:00:c9:b8:2d", "state": "reachable", "remote": false, "timestamp": 1619275264358,
    "active": true}, {"namespace": "nxos", "hostname": "exit01", "ipAddress": "169.254.254.6",
    "oif": "Ethernet1/3.3", "macaddr": "52:54:00:c9:b8:2d", "state": "reachable",
    "remote": false, "timestamp": 1619275264358, "active": true}, {"namespace": "nxos",
    "hostname": "exit01", "ipAddress": "169.254.254.10", "oif": "Ethernet1/3.4", "macaddr":
    "52:54:00:c9:b8:2d", "state": "reachable", "remote": false, "timestamp": 1619275264358,
    "active": true}, {"namespace": "nxos", "hostname": "exit01", "ipAddress": "169.254.127.0",
    "oif": "Ethernet1/4", "macaddr": "02:05:86:71:3c:03", "state": "reachable", "remote":
    false, "timestamp": 1619275264358, "active": true}, {"namespace": "nxos", "hostname":
    "exit01", "ipAddress": "10.0.0.22", "oif": "Ethernet1/2", "macaddr": "44:01:01:02:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275264358, "active": true},
    {"namespace": "nxos", "hostname": "exit01", "ipAddress": "10.0.0.21", "oif": "Ethernet1/1",
    "macaddr": "44:01:01:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275264358, "active": true}, {"namespace": "nxos", "hostname": "exit01", "ipAddress":
    "10.255.2.1", "oif": "mgmt0", "macaddr": "52:54:00:9b:7d:db", "state": "reachable",
    "remote": false, "timestamp": 1619275264358, "active": true}, {"namespace": "nxos",
    "hostname": "leaf02", "ipAddress": "172.16.1.101", "oif": "Vlan10", "macaddr":
    "32:bb:c5:b5:3a:20", "state": "reachable", "remote": false, "timestamp": 1619275264428,
    "active": true}, {"namespace": "nxos", "hostname": "leaf02", "ipAddress": "10.255.2.1",
    "oif": "mgmt0", "macaddr": "52:54:00:9b:7d:db", "state": "reachable", "remote":
    false, "timestamp": 1619275264428, "active": true}, {"namespace": "nxos", "hostname":
    "leaf02", "ipAddress": "10.255.2.189", "oif": "mgmt0", "macaddr": "44:38:39:01:02:01",
    "state": "reachable", "remote": false, "timestamp": 1619275264428, "active": true},
    {"namespace": "nxos", "hostname": "leaf02", "ipAddress": "10.0.0.21", "oif": "Ethernet1/1",
    "macaddr": "44:01:01:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275264428, "active": true}, {"namespace": "nxos", "hostname": "leaf02", "ipAddress":
    "10.0.0.22", "oif": "Ethernet1/2", "macaddr": "44:01:01:02:1b:08", "state": "reachable",
    "remote": false, "timestamp": 1619275264428, "active": true}, {"namespace": "nxos",
    "hostname": "leaf02", "ipAddress": "172.16.3.102", "oif": "Vlan30", "macaddr":
    "da:bf:63:c6:2f:0a", "state": "reachable", "remote": false, "timestamp": 1619275264428,
    "active": true}, {"namespace": "nxos", "hostname": "leaf01", "ipAddress": "10.255.2.1",
    "oif": "mgmt0", "macaddr": "52:54:00:9b:7d:db", "state": "reachable", "remote":
    false, "timestamp": 1619275264429, "active": true}, {"namespace": "nxos", "hostname":
    "leaf01", "ipAddress": "172.16.1.101", "oif": "Vlan10", "macaddr": "32:bb:c5:b5:3a:20",
    "state": "reachable", "remote": false, "timestamp": 1619275264429, "active": true},
    {"namespace": "nxos", "hostname": "leaf01", "ipAddress": "172.16.3.102", "oif":
    "Vlan30", "macaddr": "da:bf:63:c6:2f:0a", "state": "reachable", "remote": false,
    "timestamp": 1619275264429, "active": true}, {"namespace": "nxos", "hostname":
    "leaf01", "ipAddress": "10.255.2.188", "oif": "mgmt0", "macaddr": "44:38:39:01:02:02",
    "state": "reachable", "remote": false, "timestamp": 1619275264429, "active": true},
    {"namespace": "nxos", "hostname": "leaf01", "ipAddress": "10.0.0.21", "oif": "Ethernet1/1",
    "macaddr": "44:01:01:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275264429, "active": true}, {"namespace": "nxos", "hostname": "leaf01", "ipAddress":
    "10.0.0.22", "oif": "Ethernet1/2", "macaddr": "44:01:01:02:1b:08", "state": "reachable",
    "remote": false, "timestamp": 1619275264429, "active": true}, {"namespace": "nxos",
    "hostname": "leaf04", "ipAddress": "10.255.2.1", "oif": "mgmt0", "macaddr": "52:54:00:9b:7d:db",
    "state": "reachable", "remote": false, "timestamp": 1619275264853, "active": true},
    {"namespace": "nxos", "hostname": "leaf04", "ipAddress": "10.255.2.190", "oif":
    "mgmt0", "macaddr": "44:38:39:01:02:03", "state": "reachable", "remote": false,
    "timestamp": 1619275264853, "active": true}, {"namespace": "nxos", "hostname":
    "leaf04", "ipAddress": "10.0.0.21", "oif": "Ethernet1/1", "macaddr": "44:01:01:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275264853, "active": true},
    {"namespace": "nxos", "hostname": "leaf04", "ipAddress": "10.0.0.22", "oif": "Ethernet1/2",
    "macaddr": "44:01:01:02:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275264853, "active": true}, {"namespace": "nxos", "hostname": "leaf04", "ipAddress":
    "172.16.2.201", "oif": "Vlan20", "macaddr": "06:a8:f1:19:b8:b3", "state": "reachable",
    "remote": false, "timestamp": 1619275264853, "active": true}, {"namespace": "nxos",
    "hostname": "leaf04", "ipAddress": "172.16.3.202", "oif": "Vlan30", "macaddr":
    "0a:b5:b6:22:53:72", "state": "reachable", "remote": false, "timestamp": 1619275264853,
    "active": true}]'
- command: arpnd show --macaddr="44:01:03:01:1b:08" --format=json
  data-directory: tests/data/nxos/parquet-out/
  marks: arpnd show nxos
  output: '[{"namespace": "nxos", "hostname": "firewall01", "ipAddress": "169.254.254.9",
    "oif": "eth1.4", "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275256617}, {"namespace": "nxos", "hostname": "firewall01",
    "ipAddress": "169.254.254.5", "oif": "eth1.3", "macaddr": "44:01:03:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275256617}, {"namespace":
    "nxos", "hostname": "firewall01", "ipAddress": "169.254.254.1", "oif": "eth1.2",
    "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275256617}, {"namespace": "nxos", "hostname": "dcedge01", "ipAddress": "169.254.127.1",
    "oif": "xe-0/0/0.0", "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275261428}, {"namespace": "nxos", "hostname": "spine02",
    "ipAddress": "10.0.0.31", "oif": "Ethernet1/5", "macaddr": "44:01:03:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275262853}, {"namespace":
    "nxos", "hostname": "spine01", "ipAddress": "10.0.0.31", "oif": "Ethernet1/5",
    "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275263663}]'
- command: arpnd show --macaddr="44:01:03:01:1B:08" --format=json
  data-directory: tests/data/nxos/parquet-out/
  marks: arpnd show nxos
  output: '[{"namespace": "nxos", "hostname": "firewall01", "ipAddress": "169.254.254.9",
    "oif": "eth1.4", "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275256617}, {"namespace": "nxos", "hostname": "firewall01",
    "ipAddress": "169.254.254.5", "oif": "eth1.3", "macaddr": "44:01:03:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275256617}, {"namespace":
    "nxos", "hostname": "firewall01", "ipAddress": "169.254.254.1", "oif": "eth1.2",
    "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275256617}, {"namespace": "nxos", "hostname": "dcedge01", "ipAddress": "169.254.127.1",
    "oif": "xe-0/0/0.0", "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275261428}, {"namespace": "nxos", "hostname": "spine02",
    "ipAddress": "10.0.0.31", "oif": "Ethernet1/5", "macaddr": "44:01:03:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275262853}, {"namespace":
    "nxos", "hostname": "spine01", "ipAddress": "10.0.0.31", "oif": "Ethernet1/5",
    "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275263663}]'
- command: arpnd show --macaddr="4401.0301.1b08" --format=json
  data-directory: tests/data/nxos/parquet-out/
  marks: arpnd show nxos
  output: '[{"namespace": "nxos", "hostname": "firewall01", "ipAddress": "169.254.254.9",
    "oif": "eth1.4", "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275256617}, {"namespace": "nxos", "hostname": "firewall01",
    "ipAddress": "169.254.254.5", "oif": "eth1.3", "macaddr": "44:01:03:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275256617}, {"namespace":
    "nxos", "hostname": "firewall01", "ipAddress": "169.254.254.1", "oif": "eth1.2",
    "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275256617}, {"namespace": "nxos", "hostname": "dcedge01", "ipAddress": "169.254.127.1",
    "oif": "xe-0/0/0.0", "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275261428}, {"namespace": "nxos", "hostname": "spine02",
    "ipAddress": "10.0.0.31", "oif": "Ethernet1/5", "macaddr": "44:01:03:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275262853}, {"namespace":
    "nxos", "hostname": "spine01", "ipAddress": "10.0.0.31", "oif": "Ethernet1/5",
    "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275263663}]'
- command: arpnd show --macaddr="4401.0301.1B08" --format=json
  data-directory: tests/data/nxos/parquet-out/
  marks: arpnd show nxos
  output: '[{"namespace": "nxos", "hostname": "firewall01", "ipAddress": "169.254.254.9",
    "oif": "eth1.4", "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275256617}, {"namespace": "nxos", "hostname": "firewall01",
    "ipAddress": "169.254.254.5", "oif": "eth1.3", "macaddr": "44:01:03:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275256617}, {"namespace":
    "nxos", "hostname": "firewall01", "ipAddress": "169.254.254.1", "oif": "eth1.2",
    "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275256617}, {"namespace": "nxos", "hostname": "dcedge01", "ipAddress": "169.254.127.1",
    "oif": "xe-0/0/0.0", "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275261428}, {"namespace": "nxos", "hostname": "spine02",
    "ipAddress": "10.0.0.31", "oif": "Ethernet1/5", "macaddr": "44:01:03:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275262853}, {"namespace":
    "nxos", "hostname": "spine01", "ipAddress": "10.0.0.31", "oif": "Ethernet1/5",
    "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275263663}]'
- command: arpnd show --address="169.254.253.1" --format=json
  data-directory: tests/data/nxos/parquet-out/
  marks: arpnd show nxos filter
  output: '[{"namespace": "nxos", "hostname": "firewall01", "ipAddress": "169.254.253.1",
    "oif": "eth2.2", "macaddr": "44:01:03:02:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275256617}]'
- command: arpnd show --address="169.254.253.1 169.254.253.2" --format=json
  data-directory: tests/data/nxos/parquet-out/
  marks: arpnd show nxos filter
  output: '[{"namespace": "nxos", "hostname": "firewall01", "ipAddress": "169.254.253.1",
    "oif": "eth2.2", "macaddr": "44:01:03:02:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275256617}, {"namespace": "nxos", "hostname": "exit02",
    "ipAddress": "169.254.253.2", "oif": "Ethernet1/3.2", "macaddr": "52:54:00:86:df:51",
    "state": "reachable", "remote": false, "timestamp": 1619275264340}]'
- command: arpnd show --address="invalidaddress" --format=json
  data-directory: tests/data/nxos/parquet-out/
  error:
    error: '[{"error": "Invalid IP address specified"}]'
  marks: arpnd show nxos filter
- command: arpnd show --macaddr="44:01:03:01:1B:08 0205.8671.3c03" --format=json
  data-directory: tests/data/nxos/parquet-out/
  marks: arpnd show nxos filter
  output: '[{"namespace": "nxos", "hostname": "firewall01", "ipAddress": "169.254.254.9",
    "oif": "eth1.4", "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275256617}, {"namespace": "nxos", "hostname": "firewall01",
    "ipAddress": "169.254.254.5", "oif": "eth1.3", "macaddr": "44:01:03:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275256617}, {"namespace":
    "nxos", "hostname": "firewall01", "ipAddress": "169.254.254.1", "oif": "eth1.2",
    "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275256617}, {"namespace": "nxos", "hostname": "dcedge01", "ipAddress": "169.254.127.1",
    "oif": "xe-0/0/0.0", "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275261428}, {"namespace": "nxos", "hostname": "spine02",
    "ipAddress": "10.0.0.31", "oif": "Ethernet1/5", "macaddr": "44:01:03:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275262853}, {"namespace":
    "nxos", "hostname": "spine01", "ipAddress": "10.0.0.31", "oif": "Ethernet1/5",
    "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275263663}, {"namespace": "nxos", "hostname": "exit01", "ipAddress": "169.254.127.0",
    "oif": "Ethernet1/4", "macaddr": "02:05:86:71:3c:03", "state": "reachable", "remote":
    false, "timestamp": 1619275264358}]'
- command: arpnd show --macaddr="invalidaddress" --format=json
  data-directory: tests/data/nxos/parquet-out/
  error:
    error: '[{"error": "Invalid mac address specified"}]'
  marks: arpnd show nxos filter
- command: arpnd show --prefix="169.254.253.0/24" --format=json
  data-directory: tests/data/nxos/parquet-out/
  marks: arpnd show nxos filter
  output: '[{"namespace": "nxos", "hostname": "firewall01", "ipAddress": "169.254.253.5",
    "oif": "eth2.3", "macaddr": "44:01:03:02:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275256617}, {"namespace": "nxos", "hostname": "firewall01",
    "ipAddress": "169.254.253.9", "oif": "eth2.4", "macaddr": "44:01:03:02:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275256617}, {"namespace":
    "nxos", "hostname": "firewall01", "ipAddress": "169.254.253.1", "oif": "eth2.2",
    "macaddr": "44:01:03:02:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275256617}, {"namespace": "nxos", "hostname": "exit02", "ipAddress": "169.254.253.6",
    "oif": "Ethernet1/3.3", "macaddr": "52:54:00:86:df:51", "state": "reachable",
    "remote": false, "timestamp": 1619275264340}, {"namespace": "nxos", "hostname":
    "exit02", "ipAddress": "169.254.253.2", "oif": "Ethernet1/3.2", "macaddr": "52:54:00:86:df:51",
    "state": "reachable", "remote": false, "timestamp": 1619275264340}, {"namespace":
    "nxos", "hostname": "exit02", "ipAddress": "169.254.253.10", "oif": "Ethernet1/3.4",
    "macaddr": "52:54:00:86:df:51", "state": "reachable", "remote": false, "timestamp":
    1619275264340}]'
- command: arpnd show --prefix="169.254.253.0/24 10.0.0.0/24" --format=json
  data-directory: tests/data/nxos/parquet-out/
  marks: arpnd show nxos filter
  output: '[{"namespace": "nxos", "hostname": "firewall01", "ipAddress": "169.254.253.5",
    "oif": "eth2.3", "macaddr": "44:01:03:02:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275256617}, {"namespace": "nxos", "hostname": "firewall01",
    "ipAddress": "169.254.253.9", "oif": "eth2.4", "macaddr": "44:01:03:02:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275256617}, {"namespace":
    "nxos", "hostname": "firewall01", "ipAddress": "169.254.253.1", "oif": "eth2.2",
    "macaddr": "44:01:03:02:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275256617}, {"namespace": "nxos", "hostname": "spine02", "ipAddress": "10.0.0.11",
    "oif": "Ethernet1/1", "macaddr": "44:01:02:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275262853}, {"namespace": "nxos", "hostname": "spine02",
    "ipAddress": "10.0.0.12", "oif": "Ethernet1/2", "macaddr": "44:01:02:02:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275262853}, {"namespace":
    "nxos", "hostname": "spine02", "ipAddress": "10.0.0.13", "oif": "Ethernet1/3",
    "macaddr": "44:01:02:03:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275262853}, {"namespace": "nxos", "hostname": "spine02", "ipAddress": "10.0.0.14",
    "oif": "Ethernet1/4", "macaddr": "44:01:02:04:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275262853}, {"namespace": "nxos", "hostname": "spine02",
    "ipAddress": "10.0.0.31", "oif": "Ethernet1/5", "macaddr": "44:01:03:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275262853}, {"namespace":
    "nxos", "hostname": "spine02", "ipAddress": "10.0.0.32", "oif": "Ethernet1/6",
    "macaddr": "44:01:03:02:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275262853}, {"namespace": "nxos", "hostname": "leaf03", "ipAddress": "10.0.0.22",
    "oif": "Ethernet1/2", "macaddr": "44:01:01:02:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275263495}, {"namespace": "nxos", "hostname": "leaf03",
    "ipAddress": "10.0.0.21", "oif": "Ethernet1/1", "macaddr": "44:01:01:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275263495}, {"namespace":
    "nxos", "hostname": "spine01", "ipAddress": "10.0.0.11", "oif": "Ethernet1/1",
    "macaddr": "44:01:02:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275263663}, {"namespace": "nxos", "hostname": "spine01", "ipAddress": "10.0.0.13",
    "oif": "Ethernet1/3", "macaddr": "44:01:02:03:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275263663}, {"namespace": "nxos", "hostname": "spine01",
    "ipAddress": "10.0.0.14", "oif": "Ethernet1/4", "macaddr": "44:01:02:04:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275263663}, {"namespace":
    "nxos", "hostname": "spine01", "ipAddress": "10.0.0.32", "oif": "Ethernet1/6",
    "macaddr": "44:01:03:02:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275263663}, {"namespace": "nxos", "hostname": "spine01", "ipAddress": "10.0.0.31",
    "oif": "Ethernet1/5", "macaddr": "44:01:03:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275263663}, {"namespace": "nxos", "hostname": "spine01",
    "ipAddress": "10.0.0.12", "oif": "Ethernet1/2", "macaddr": "44:01:02:02:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275263663}, {"namespace":
    "nxos", "hostname": "exit02", "ipAddress": "10.0.0.21", "oif": "Ethernet1/1",
    "macaddr": "44:01:01:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275264340}, {"namespace": "nxos", "hostname": "exit02", "ipAddress": "169.254.253.6",
    "oif": "Ethernet1/3.3", "macaddr": "52:54:00:86:df:51", "state": "reachable",
    "remote": false, "timestamp": 1619275264340}, {"namespace": "nxos", "hostname":
    "exit02", "ipAddress": "169.254.253.2", "oif": "Ethernet1/3.2", "macaddr": "52:54:00:86:df:51",
    "state": "reachable", "remote": false, "timestamp": 1619275264340}, {"namespace":
    "nxos", "hostname": "exit02", "ipAddress": "169.254.253.10", "oif": "Ethernet1/3.4",
    "macaddr": "52:54:00:86:df:51", "state": "reachable", "remote": false, "timestamp":
    1619275264340}, {"namespace": "nxos", "hostname": "exit02", "ipAddress": "10.0.0.22",
    "oif": "Ethernet1/2", "macaddr": "44:01:01:02:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275264340}, {"namespace": "nxos", "hostname": "exit01",
    "ipAddress": "10.0.0.22", "oif": "Ethernet1/2", "macaddr": "44:01:01:02:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275264358}, {"namespace":
    "nxos", "hostname": "exit01", "ipAddress": "10.0.0.21", "oif": "Ethernet1/1",
    "macaddr": "44:01:01:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275264358}, {"namespace": "nxos", "hostname": "leaf02", "ipAddress": "10.0.0.21",
    "oif": "Ethernet1/1", "macaddr": "44:01:01:01:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275264428}, {"namespace": "nxos", "hostname": "leaf02",
    "ipAddress": "10.0.0.22", "oif": "Ethernet1/2", "macaddr": "44:01:01:02:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275264428}, {"namespace":
    "nxos", "hostname": "leaf01", "ipAddress": "10.0.0.21", "oif": "Ethernet1/1",
    "macaddr": "44:01:01:01:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275264429}, {"namespace": "nxos", "hostname": "leaf01", "ipAddress": "10.0.0.22",
    "oif": "Ethernet1/2", "macaddr": "44:01:01:02:1b:08", "state": "reachable", "remote":
    false, "timestamp": 1619275264429}, {"namespace": "nxos", "hostname": "leaf04",
    "ipAddress": "10.0.0.21", "oif": "Ethernet1/1", "macaddr": "44:01:01:01:1b:08",
    "state": "reachable", "remote": false, "timestamp": 1619275264853}, {"namespace":
    "nxos", "hostname": "leaf04", "ipAddress": "10.0.0.22", "oif": "Ethernet1/2",
    "macaddr": "44:01:01:02:1b:08", "state": "reachable", "remote": false, "timestamp":
    1619275264853}]'
- command: arpnd show --prefix="169.254.253.0" --format=json
  data-directory: tests/data/nxos/parquet-out/
  error:
    error: '[{"error": "Invalid prefix specified"}]'
  marks: arpnd show nxos filter
